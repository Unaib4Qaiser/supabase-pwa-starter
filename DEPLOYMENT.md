# Deployment Guide: Supabase PWA Starter to Vercel

This guide will walk you through deploying your Supabase PWA Starter to Vercel.

## Prerequisites

1. A Vercel account (free at [vercel.com](https://vercel.com))
2. A Supabase account and project (free at [supabase.com](https://supabase.com))
3. This project's code

## Step 1: Set up your Supabase Project

1. Create a new project on [Supabase](https://supabase.com)
2. Get your project's URL and anon key from the project settings
3. Run the SQL setup from `database-setup.sql` in your Supabase SQL editor:

   ```sql
   -- Enable pgcrypto if not enabled (for gen_random_uuid)
   create extension if not exists pgcrypto;

   create table if not exists public.notes (
     id uuid primary key default gen_random_uuid(),
     user_id uuid not null references auth.users(id) on delete cascade,
     content text not null,
     inserted_at timestamptz not null default now()
   );

   alter table public.notes enable row level security;

   -- Only owners can CRUD their notes
   create policy "Owners can read own notes" on public.notes
     for select using (auth.uid() = user_id);

   create policy "Owners can insert notes" on public.notes
     for insert with check (auth.uid() = user_id);

   create policy "Owners can update own notes" on public.notes
     for update using (auth.uid() = user_id);

   create policy "Owners can delete own notes" on public.notes
     for delete using (auth.uid() = user_id);
   ```

## Step 2: Deploy to Vercel

### Option 1: Connect GitHub Repository (Recommended)

1. Push your code to a GitHub repository
2. Go to [Vercel Dashboard](https://vercel.com/dashboard)
3. Click "New Project"
4. Import your repository
5. Configure project settings:
   - Framework Preset: Vite
   - Root Directory: / (or where your project is located)
6. Set environment variables in the "Environment Variables" section:
   - `VITE_SUPABASE_URL` = Your Supabase project URL
   - `VITE_SUPABASE_ANON_KEY` = Your Supabase anon key
7. Click "Deploy"

### Option 2: Deploy using Vercel CLI

1. Install Vercel CLI globally:

   ```bash
   npm install -g vercel
   ```

2. Login to your Vercel account:

   ```bash
   vercel login
   ```

3. Deploy your project:

   ```bash
   vercel
   ```

4. During the deployment process:
   - Set up and configure your project
   - Link to existing project or create a new one
   - When prompted, add the environment variables:
     - `VITE_SUPABASE_URL` = Your Supabase project URL
     - `VITE_SUPABASE_ANON_KEY` = Your Supabase anon key

## Step 3: Configure Environment Variables

Whether you deploy via GitHub or CLI, you'll need to set these environment variables in your Vercel project settings:

1. Go to your project in the Vercel Dashboard
2. Click "Settings" → "Environment Variables"
3. Add these variables:
   - `VITE_SUPABASE_URL` = Your Supabase project URL
   - `VITE_SUPABASE_ANON_KEY` = Your Supabase anon key

## Step 4: Configure Supabase Auth Redirect URLs

In your Supabase project dashboard:

1. Go to Authentication → URL Configuration
2. Add your Vercel deployment URL to "Redirect URLs":
   - For example: `https://your-project.vercel.app/**`
   - Also add `http://localhost:5173/**` for local development

## Step 5: Redeploy

After adding environment variables, you'll need to redeploy:

1. Go to your project in the Vercel Dashboard
2. Click "Deployments"
3. Click the "..." menu on the latest deployment
4. Select "Redeploy"

## PWA Considerations

This project is configured as a PWA with offline capabilities:

- The service worker is automatically generated by `vite-plugin-pwa`
- Assets are cached for offline use
- The app can be installed on devices that support PWAs

For custom caching strategies, you can modify the `VitePWA()` options in `vite.config.ts`.

## Troubleshooting

1. **Environment variables not loading**: Make sure you've added them in Vercel project settings and redeployed
2. **Supabase connection issues**: Verify your Supabase URL and anon key are correct
3. **Auth redirect errors**: Ensure your Supabase redirect URLs include your Vercel deployment URL
4. **PWA not working**: Check that all icons are properly configured in `public/icons/`

## Local Development

To run locally after deployment:

```bash
# Create your .env file with your Supabase credentials
cp .env.example .env
# Edit .env with your Supabase URL and anon key

# Install dependencies
npm install

# Run development server
npm run dev
```
